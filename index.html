<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三瑩●設計 │ 您的夢想藍圖，我們用心實現</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        .hero-bg {
            background-image: url('https://images.unsplash.com/photo-1618220179428-22790b461013?q=80&w=2127&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }
        .section-title {
            letter-spacing: 0.1em;
        }
        .fade-in {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        .card-hover {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        /* Loading Skeleton Animation */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-stone-700 tracking-wider flex items-center">
                三瑩<span class="text-amber-600 text-sm px-2 align-middle">●</span>設計
            </div>
            <nav class="hidden md:flex space-x-8 items-center">
                <a href="#features" class="text-stone-600 hover:text-amber-600 transition-colors">核心優勢</a>
                <a href="#concept" class="text-stone-600 hover:text-amber-600 transition-colors">專業證照</a>
                <a href="#services" class="text-stone-600 hover:text-amber-600 transition-colors">服務項目</a>
                <a href="#gallery" class="text-stone-600 hover:text-amber-600 transition-colors">案例欣賞</a>
                <a href="https://www.facebook.com/groups/triwin" target="_blank" class="bg-amber-600 text-white px-5 py-2 rounded-full hover:bg-amber-700 transition-all shadow-md hover:shadow-lg">
                    立即諮詢
                </a>
            </nav>
            <div class="md:hidden">
                 <a href="https://www.facebook.com/groups/triwin" target="_blank" class="bg-amber-600 text-white px-4 py-2 rounded-full hover:bg-amber-700 transition-all text-sm">
                    免費諮詢
                </a>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <main>
        <section class="hero-bg relative h-[600px] text-white flex items-center">
            <div class="absolute inset-0 bg-black/50"></div>
            <div class="container mx-auto px-6 text-center relative z-10">
                <h1 class="text-4xl md:text-6xl font-bold leading-tight mb-4 tracking-wide fade-in">您的夢想藍圖，我們用心實現</h1>
                <p class="text-lg md:text-2xl text-stone-200 mb-8 fade-in" style="transition-delay: 200ms;">不只懂木工，更懂您的心。我們在美觀、實用與預算中，為您找到完美平衡。</p>
                <a href="https://www.facebook.com/groups/triwin" target="_blank" class="bg-amber-600 text-white px-8 py-4 rounded-full text-lg font-semibold hover:bg-amber-700 transition-all shadow-lg hover:shadow-xl transform hover:scale-105 fade-in" style="transition-delay: 400ms;">
                    開啟您與理想空間的對話
                </a>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-sm font-bold text-amber-600 uppercase section-title fade-in">厭倦了裝潢的溝通惡夢？</h2>
                    <p class="text-3xl md:text-4xl font-bold text-stone-800 mt-2 fade-in" style="transition-delay: 100ms;">我們最大的特色：木工與水電的完美整合</p>
                    <p class="mt-4 max-w-2xl mx-auto text-stone-600 fade-in" style="transition-delay: 200ms;">
                        裝潢最大的痛點，是不同工種間的溝通與銜接。三瑩讓裝潢變簡單了！
                    </p>
                </div>
                <div class="grid md:grid-cols-3 gap-8 text-center">
                    <!-- Feature 1 -->
                    <div class="bg-stone-50 p-8 rounded-2xl card-hover fade-in" style="transition-delay: 300ms;">
                        <div class="flex items-center justify-center h-16 w-16 bg-amber-100 text-amber-600 rounded-full mx-auto mb-6">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a2 2 0 01-2-2V4a2 2 0 012-2h6a2 2 0 012 2v4z" /></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">溝通零斷層</h3>
                        <p class="text-stone-600">一個窗口對到底，從設計到施工，您的想法精準傳達，溝通不心累。</p>
                    </div>
                    <!-- Feature 2 -->
                    <div class="bg-stone-50 p-8 rounded-2xl card-hover fade-in" style="transition-delay: 400ms;">
                        <div class="flex items-center justify-center h-16 w-16 bg-amber-100 text-amber-600 rounded-full mx-auto mb-6">
                             <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" /></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">工序超流暢</h3>
                        <p class="text-stone-600">動線、插座、出水口一步到位，無縫施工超效率，進度絕不延遲。</p>
                    </div>
                    <!-- Feature 3 -->
                    <div class="bg-stone-50 p-8 rounded-2xl card-hover fade-in" style="transition-delay: 500ms;">
                        <div class="flex items-center justify-center h-16 w-16 bg-amber-100 text-amber-600 rounded-full mx-auto mb-6">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 10l-2 1m0 0l-2-1m2 1v2.5M20 7l-2 1m2-1l-2-1m2 1v2.5M14 4l-2-1-2 1M4 7l2 1M4 7l2-1M4 7v2.5M12 21l-2-1m2 1l2-1m-2 1v-2.5M6 18l-2-1v-2.5M18 18l2-1v-2.5" /></svg>
                        </div>
                        <h3 class="text-xl font-bold mb-2">空間更極致</h3>
                        <p class="text-stone-600">木作與管線完美結合，不浪費一寸空間，將設計感發揮到極致。</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Concept Section -->
        <section id="concept" class="py-20 bg-stone-100">
            <div class="container mx-auto px-6">
                <div class="flex flex-col md:flex-row items-center gap-12">
                    <div class="md:w-1/3 text-center fade-in flex justify-center">
                        <div class="relative bg-white p-2 rounded-lg shadow-xl hover:scale-105 transition-transform duration-300">
                             <img src="https://i.meee.com.tw/wBt4knY.png" alt="專業證照" class="w-auto h-48 md:h-64 object-contain rounded">
                        </div>
                    </div>
                    <div class="md:w-2/3 text-center md:text-left fade-in" style="transition-delay: 200ms;">
                        <h2 class="text-sm font-bold text-amber-600 uppercase section-title">OUR CONCEPT</h2>
                        <p class="text-3xl md:text-4xl font-bold text-stone-800 mt-2">專業證照，品質保障</p>
                        <p class="mt-4 text-stone-600 max-w-xl mx-auto md:mx-0">
                            擁有合格專業證照，我們提供裝修服務更注重施工品質，安全有保障。
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="services" class="py-20 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-sm font-bold text-amber-600 uppercase section-title fade-in">SERVICE</h2>
                    <p class="text-3xl md:text-4xl font-bold text-stone-800 mt-2 fade-in" style="transition-delay: 100ms;">服務項目</p>
                </div>
                <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                    <!-- Service Card 1 -->
                    <div class="bg-stone-50 rounded-2xl card-hover fade-in overflow-hidden flex flex-col" style="transition-delay: 200ms;">
                        <img src="https://i.meee.com.tw/myCHvup.png" alt="木工裝潢" class="w-full h-40 object-cover">
                        <div class="p-6 flex-grow">
                            <h3 class="font-bold text-lg">木工裝潢</h3>
                            <p class="text-stone-600 text-sm mt-2">造型天花板、室內木作裝潢、客製櫥櫃、系統櫃</p>
                        </div>
                    </div>
                    <!-- Service Card 2 -->
                    <div class="bg-stone-50 rounded-2xl card-hover fade-in overflow-hidden flex flex-col" style="transition-delay: 300ms;">
                        <img src="https://images.unsplash.com/photo-1596079890744-c1a0462d0975?q=80&w=1771&auto=format&fit=crop" alt="室內設計" class="w-full h-40 object-cover">
                        <div class="p-6 flex-grow">
                            <h3 class="font-bold text-lg">室內設計</h3>
                            <p class="text-stone-600 text-sm mt-2">居家設計、商業空間設計</p>
                        </div>
                    </div>
                    <!-- Service Card 3 -->
                    <div class="bg-stone-50 rounded-2xl card-hover fade-in overflow-hidden flex flex-col" style="transition-delay: 400ms;">
                        <img src="https://i.meee.com.tw/AYbKsFg.png" alt="老屋翻新" class="w-full h-40 object-cover">
                        <div class="p-6 flex-grow">
                            <h3 class="font-bold text-lg">老屋翻新</h3>
                            <p class="text-stone-600 text-sm mt-2">整體規劃翻新、局部翻新</p>
                        </div>
                    </div>
                    <!-- Service Card 4 -->
                    <div class="bg-stone-50 rounded-2xl card-hover fade-in overflow-hidden flex flex-col" style="transition-delay: 500ms;">
                         <img src="https://images.unsplash.com/photo-1541888946425-d81bb19240f5?q=80&w=1770&auto=format&fit=crop" alt="統包工程" class="w-full h-40 object-cover">
                        <div class="p-6 flex-grow">
                            <h3 class="font-bold text-lg">統包工程</h3>
                            <p class="text-stone-600 text-sm mt-2">泥作、隔間、水電、油漆、防水、修繕</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Gallery Section -->
        <section id="gallery" class="py-20 bg-stone-100">
            <div class="container mx-auto px-6">
                <div class="text-center mb-16">
                    <h2 class="text-sm font-bold text-amber-600 uppercase section-title fade-in">PORTFOLIO</h2>
                    <p class="text-3xl md:text-4xl font-bold text-stone-800 mt-2 fade-in" style="transition-delay: 100ms;">案例欣賞</p>
                </div>
                
                <!-- Gallery Container: Dynamic Content will be injected here -->
                <div id="gallery-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 min-h-[400px]">
                    <!-- Loading Skeletons -->
                    <div class="bg-white rounded-2xl overflow-hidden shadow-sm h-96 flex flex-col skeleton"></div>
                    <div class="bg-white rounded-2xl overflow-hidden shadow-sm h-96 flex flex-col skeleton"></div>
                    <div class="bg-white rounded-2xl overflow-hidden shadow-sm h-96 flex flex-col skeleton"></div>
                </div>
            </div>
        </section>

        <!-- CTA Section -->
        <section id="contact" class="bg-amber-600 text-white">
            <div class="container mx-auto px-6 py-20 text-center">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 fade-in">您的家，值得最好的對待。</h2>
                <p class="text-lg text-amber-100 max-w-2xl mx-auto mb-8 fade-in" style="transition-delay: 200ms;">
                    讓我們成為您打造夢想空間的神隊友。立即點擊下方按鈕，預約免費諮詢，讓我們聽聽您的故事。
                </p>
                <a href="https://www.facebook.com/groups/triwin" target="_blank" class="bg-white text-amber-700 px-8 py-4 rounded-full text-lg font-semibold hover:bg-amber-50 transition-all shadow-lg hover:shadow-xl transform hover:scale-105 fade-in" style="transition-delay: 400ms;">
                    預約免費諮詢
                </a>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="bg-stone-800 text-stone-300">
        <div class="container mx-auto px-6 py-10">
            <div class="grid md:grid-cols-3 gap-8 text-center md:text-left">
                <div class="md:col-span-1">
                    <h3 class="text-xl font-bold text-white mb-2 flex items-center justify-center md:justify-start">
                        三瑩<span class="text-amber-500 text-xs px-2 align-middle">●</span>設計
                    </h3>
                    <p class="text-sm text-stone-400">您的夢想藍圖，我們用心實現。</p>
                    <div class="flex space-x-4 mt-4 justify-center md:justify-start">
                        <a href="https://www.facebook.com/groups/triwin" target="_blank" class="text-stone-400 hover:text-white" aria-label="Facebook"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v2.385z"/></svg></a>
                        <a href="https://maps.app.goo.gl/r7BRvuSVeXV95w9k6?g_st=ic" target="_blank" class="text-stone-400 hover:text-white" aria-label="Google Maps"><svg class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg></a>
                    </div>
                </div>
                <div>
                    <h3 class="font-semibold text-white mb-4">服務區域 <span class="block text-xs text-stone-400">Service Area</span></h3>
                    <ul class="text-sm text-stone-400 space-y-2">
                        <li>台中、苗栗、南投、彰化</li>
                        <li>其他地區歡迎洽詢</li>
                    </ul>
                </div>
                 <div>
                    <h3 class="font-semibold text-white mb-4">標籤</h3>
                    <div class="flex flex-wrap gap-2 text-xs text-stone-400 justify-center md:justify-start">
                        <span class="bg-stone-700 px-2 py-1 rounded">#木作統包工程</span>
                        <span class="bg-stone-700 px-2 py-1 rounded">#系統櫃工程</span>
                        <span class="bg-stone-700 px-2 py-1 rounded">#老屋翻新</span>
                        <span class="bg-stone-700 px-2 py-1 rounded">#木工水電整合</span>
                    </div>
                </div>
            </div>
            <div class="mt-8 border-t border-stone-700 pt-6 text-center text-xs text-stone-500">
                <p>&copy; 2025 三瑩室內裝修有限公司. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <!-- LINE Floating Button -->
    <a href="https://lin.ee/dmVifL2" target="_blank" class="fixed bottom-6 right-6 z-[999] flex items-center justify-center w-14 h-14 bg-[#06C755] hover:bg-[#05b34c] text-white rounded-full shadow-lg transition-all duration-300 hover:scale-110 hover:-translate-y-1 group">
        <!-- Tooltip -->
        <span class="absolute right-full mr-3 bg-white text-stone-700 px-3 py-1 rounded-lg text-sm font-bold shadow-md opacity-0 group-hover:opacity-100 transition-opacity duration-300 whitespace-nowrap pointer-events-none">
            加 LINE 諮詢
        </span>
        <!-- LINE Icon -->
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" viewBox="0 0 16 16">
            <path d="M8 0c4.418 0 8 2.972 8 6.637 0 3.665-3.582 6.637-8 6.637-.927 0-1.823-.13-2.67-.372-1.077.672-2.883 1.256-3.048 1.3-.16.04-.326-.068-.31-.237.016-.168.202-1.07.76-2.07C.942 10.457 0 8.636 0 6.637 0 2.972 3.582 0 8 0zm.603 5.305h-1.63v2.662H8.603a.355.355 0 1 1 0 .71H6.618a.355.355 0 0 1-.355-.355V5.305a.355.355 0 0 1 .355-.355h1.988a.355.355 0 1 1 0 .71zm-4.326 0h1.63a.355.355 0 1 1 0 .71h-1.275v2.662a.355.355 0 1 1-.71 0V5.305zm7.398 0h.355a.355.355 0 1 1 0 .71h-.355v.93l1.458-1.6a.356.356 0 0 1 .26-.11h.003a.355.355 0 0 1 .355.355v3.372a.355.355 0 1 1-.71 0v-.928l-1.46 1.602a.355.355 0 0 1-.617-.263V5.305zm-2.835 0h.355a.355.355 0 0 1 .355.355v2.662a.355.355 0 0 1-.355.355h-.355a.355.355 0 0 1-.355-.355V5.66a.355.355 0 0 1 .355-.355z"/>
        </svg>
    </a>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const faders = document.querySelectorAll('.fade-in');

            const appearOptions = {
                threshold: 0.1,
                rootMargin: "0px 0px -50px 0px"
            };

            const appearOnScroll = new IntersectionObserver(function(entries, appearOnScroll) {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) {
                        return;
                    } else {
                        entry.target.classList.add('visible');
                        appearOnScroll.unobserve(entry.target);
                    }
                });
            }, appearOptions);

            faders.forEach(fader => {
                appearOnScroll.observe(fader);
            });

            // Smooth scrolling for navigation links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    document.querySelector(this.getAttribute('href')).scrollIntoView({
                        behavior: 'smooth'
                    });
                });
            });

            // --------------------------------------------------------
            // Google Sheet API Logic
            // --------------------------------------------------------
            // STEP 1: 將您部署好的 Web App URL 貼在下方引號中
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyX5CWLALSSJgAMa3HG-7AAxs6zv8TQ7_-KwAAeofOCX8lBEdQ3s6vYtNrlr7j2A3go/exec'; 

            const galleryContainer = document.getElementById('gallery-container');

            async function fetchGalleryData() {
                // 如果沒有設定 URL，顯示預設訊息 (為了演示目的，若無 URL 則不執行)
                if (GOOGLE_SCRIPT_URL === '請將您的_WEB_APP_URL_貼在這裡') {
                    console.log('請先設定 Google Script URL');
                    return; 
                }

                try {
                    const response = await fetch(GOOGLE_SCRIPT_URL);
                    const data = await response.json();
                    renderGallery(data);
                } catch (error) {
                    console.error('Error fetching data:', error);
                    // 發生錯誤時保留原本的 Loading 骨架或顯示錯誤訊息，這裡選擇顯示錯誤訊息
                    galleryContainer.innerHTML = '<p class="text-center w-full col-span-3 text-stone-500">目前無法載入案例，請稍後再試。</p>';
                }
            }

            function renderGallery(cases) {
                // 清空 Loading 骨架
                galleryContainer.innerHTML = '';

                // 如果沒有資料
                if (!cases || cases.length === 0) {
                    galleryContainer.innerHTML = '<p class="text-center w-full col-span-3 text-stone-500">目前尚無案例分享。</p>';
                    return;
                }

                cases.forEach((item, index) => {
                    // 根據資料欄位名稱 (假設 Google Sheet 第一列為這些名稱)
                    // 案件編號, 案件名稱, 服務類別, 地點, 坪數, 風格, 完工日期, 封面圖連結, 設計理念, 標籤
                    
                    // 處理標籤: 將逗號分隔的字串轉為 HTML
                    let tagsHtml = '';
                    if (item['標籤']) {
                        const tags = item['標籤'].toString().split(/[,,、]/); // 支援逗號或頓號分隔
                        tagsHtml = tags.map(tag => `<span class="bg-stone-100 px-2 py-1 rounded">#${tag.trim()}</span>`).join('');
                    }

                    // 判斷是否需要跨欄 (例如每三個的第二個跨兩欄，或是隨機，這裡做簡單的順序展示)
                    // 為了保持簡單與 RWD，這裡先統一使用標準卡片，若要特殊跨欄可依 index 判斷
                    const isLarge = false; // 可依需求開啟 index % 3 === 1; 

                    // 處理圖片連結：若無圖片則使用 Placeholder
                    const imgUrl = item['封面圖連結'] ? item['封面圖連結'] : 'https://via.placeholder.com/600x400?text=No+Image';

                    const cardHtml = `
                    <div class="bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition-all duration-300 card-hover fade-in visible flex flex-col ${isLarge ? 'lg:col-span-2 flex-row' : ''}">
                        <div class="relative h-64 ${isLarge ? 'md:h-auto md:w-1/2' : ''} overflow-hidden">
                            <img src="${imgUrl}" alt="${item['案件名稱']}" class="w-full h-full object-cover transform hover:scale-110 transition-transform duration-700">
                            <div class="absolute top-4 left-4 bg-amber-600 text-white text-xs px-3 py-1 rounded-full shadow-md">${item['服務類別'] || '專案'}</div>
                        </div>
                        <div class="p-6 ${isLarge ? 'md:w-1/2 flex flex-col justify-center' : 'flex-grow'}">
                            <h3 class="text-xl font-bold text-stone-800 mb-2">${item['案件名稱']}</h3>
                            <div class="text-xs text-stone-500 mb-3 flex items-center gap-2 flex-wrap">
                                <span>${item['地點'] || ''}</span>
                                ${item['坪數'] ? `<span class="w-1 h-1 bg-stone-300 rounded-full"></span><span>${item['坪數']}</span>` : ''}
                                ${item['風格'] ? `<span class="w-1 h-1 bg-stone-300 rounded-full"></span><span>${item['風格']}</span>` : ''}
                            </div>
                            <p class="text-stone-600 text-sm mb-4 line-clamp-3">${item['設計理念'] || ''}</p>
                            <div class="flex flex-wrap gap-2 text-xs text-stone-500">
                                ${tagsHtml}
                            </div>
                        </div>
                    </div>
                    `;
                    
                    galleryContainer.insertAdjacentHTML('beforeend', cardHtml);
                });
            }

            // 啟動讀取
            fetchGalleryData();
        });
    </script>
</body>
</html>